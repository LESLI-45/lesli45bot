#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
LESLI45BOT - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—é
–í–ï–†–°–ò–Ø –ë–ï–ó OPENAI - —Å –≥–æ—Ç–æ–≤—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –∏–∑ –∫–Ω–∏–≥ –õ–µ—Å–ª–∏
"""

import logging
import os
import sys
import random

# Telegram
import telebot
from telebot import types

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.StreamHandler(sys.stdout)
    ]
)
logger = logging.getLogger(__name__)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
class Config:
    TELEGRAM_TOKEN = os.getenv('TELEGRAM_TOKEN')
    
    def __init__(self):
        if not self.TELEGRAM_TOKEN:
            logger.error("‚ùå TELEGRAM_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            sys.exit(1)

config = Config()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
bot = telebot.TeleBot(config.TELEGRAM_TOKEN)

# –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ –õ–µ—Å–ª–∏
LESLI_KNOWLEDGE = {
    "situacia": [
        "üéØ **–ê–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏ –æ—Ç –õ–µ—Å–ª–∏:**\n\n‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏ –µ—ë **—Ç–µ–∫—É—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å** (1-10)\n‚Ä¢ –í—ã—è—Å–Ω–∏ **–≤–µ–¥—É—â—É—é –º–æ—Ç–∏–≤–∞—Ü–∏—é** –¥–µ–≤—É—à–∫–∏\n‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π **–ø—Ä–∞–≤–∏–ª–æ 7 –∫–∞—Å–∞–Ω–∏–π** –¥–ª—è —Å–±–ª–∏–∂–µ–Ω–∏—è\n‚Ä¢ –í—Å–µ–≥–¥–∞ –∏–º–µ–π **–ø–ª–∞–Ω –ë** –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç–∫–∞–∑–∞\n\nüí° *'–°–∏—Ç—É–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ–º, –∫—Ç–æ –ª—É—á—à–µ –µ—ë –ø–æ–Ω–∏–º–∞–µ—Ç'*",
        
        "üéØ **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –õ–µ—Å–ª–∏:**\n\n‚Ä¢ **–ù–µ —Ç–æ—Ä–æ–ø–∏—Å—å** - –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–µ–±—è\n‚Ä¢ **–ß–∏—Ç–∞–π —Å–∏–≥–Ω–∞–ª—ã** - –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å\n‚Ä¢ **–ë—É–¥—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º** - —Ä—É—Ç–∏–Ω–∞ —É–±–∏–≤–∞–µ—Ç –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ\n‚Ä¢ **–°–æ–∑–¥–∞–≤–∞–π –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ** - –∫–æ–º—Ñ–æ—Ä—Ç —Å–Ω–∏–∂–∞–µ—Ç –∂–µ–ª–∞–Ω–∏–µ\n\nüî• *'–ñ–µ–Ω—â–∏–Ω—ã –≤–ª—é–±–ª—è—é—Ç—Å—è –≤ —ç–º–æ—Ü–∏–∏, –∞ –Ω–µ –≤ –ª–æ–≥–∏–∫—É'*"
    ],
    
    "perepiska": [
        "üí¨ **–ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –ø–æ –õ–µ—Å–ª–∏:**\n\nüî• **–ï—ë —Å–∏–≥–Ω–∞–ª—ã –∏–Ω—Ç–µ—Ä–µ—Å–∞:**\n‚Ä¢ –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã = –≤—ã—Å–æ–∫–∏–π –∏–Ω—Ç–µ—Ä–µ—Å\n‚Ä¢ –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è = –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å\n‚Ä¢ –í–æ–ø—Ä–æ—Å—ã –æ —Ç–µ–±–µ = –∂–µ–ª–∞–Ω–∏–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ\n‚Ä¢ –≠–º–æ–¥–∑–∏ –∏ —Å–º–∞–π–ª–∏–∫–∏ = —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å\n\nüì± **–ß—Ç–æ –ø–∏—Å–∞—Ç—å –¥–∞–ª—å—à–µ:**\n‚Ä¢ –ú–µ–Ω—å—à–µ —Å–ª–æ–≤, –±–æ–ª—å—à–µ —ç–º–æ—Ü–∏–π\n‚Ä¢ –°–æ–∑–¥–∞–≤–∞–π –∏–Ω—Ç—Ä–∏–≥—É –∏ –Ω–µ–¥–æ—Å–∫–∞–∑–∞–Ω–Ω–æ—Å—Ç—å\n‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥–∏ –≤ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ –∑–≤–æ–Ω–∫–∏",
        
        "üí¨ **–ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –æ—Ç –õ–µ—Å–ª–∏:**\n\n‚ùå **–ù–ï –¥–µ–ª–∞–π:**\n‚Ä¢ –î–ª–∏–Ω–Ω—ã–µ —Ä–æ–º–∞–Ω—ã –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö\n‚Ä¢ –ü–æ—Å—Ç–æ—è–Ω–Ω—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 24/7\n‚Ä¢ –ò–∑–ª–∏—à–Ω—é—é –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å\n‚Ä¢ –í–æ–ø—Ä–æ—Å—ã-–¥–æ–ø—Ä–æ—Å—ã\n\n‚úÖ **–î–ï–õ–ê–ô:**\n‚Ä¢ –ó–∞–≥–∞–¥–æ—á–Ω—ã–µ –Ω–∞–º–µ–∫–∏\n‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞—á–µ–ª–∏\n‚Ä¢ –ü–∞—É–∑—ã –≤ –æ–±—â–µ–Ω–∏–∏\n‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏"
    ],
    
    "pervoe": [
        "üì± **–ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –õ–µ—Å–ª–∏:**\n\nüéØ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**\n1. **–Ø–∫–æ—Ä—å** - –Ω–∞–ø–æ–º–Ω–∏ –≥–¥–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å\n2. **–ö–æ–º–ø–ª–∏–º–µ–Ω—Ç** - –Ω–µ –ø—Ä–æ –≤–Ω–µ—à–Ω–æ—Å—Ç—å!\n3. **–ò–Ω—Ç—Ä–∏–≥–∞** - –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è –º—ã—Å–ª—å\n4. **–ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é** - –ø—Ä–µ–¥–ª–æ–∂–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å\n\nüí° **–ü—Ä–∏–º–µ—Ä:** *'–ü—Ä–∏–≤–µ—Ç! –¢—ã —Ç–∞ —Å–∞–º–∞—è –¥–µ–≤—É—à–∫–∞ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –≤–∑–≥–ª—è–¥–æ–º –Ω–∞ –∂–∏–∑–Ω—å –∏–∑ –∫–æ—Ñ–µ–π–Ω–∏. –ö—Å—Ç–∞—Ç–∏, —Ç–∞–∫ –∏ –Ω–µ —Ä–∞—Å—Å–∫–∞–∑–∞–ª–∞ —á–µ–º –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å —Ç–≤–æ—è –∏—Å—Ç–æ—Ä–∏—è... üòä'*",
        
        "üì± **–§–æ—Ä–º—É–ª–∞ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:**\n\nüî• **3 –∫–∏—Ç–∞ —É—Å–ø–µ—Ö–∞:**\n‚Ä¢ **–õ–∏—á–Ω–æ—Å—Ç—å** - —á—Ç–æ –∑–∞—Ü–µ–ø–∏–ª–æ –≤ –Ω–µ–π\n‚Ä¢ **–≠–º–æ—Ü–∏—è** - –∫–∞–∫–∏–µ —á—É–≤—Å—Ç–≤–∞ –≤—ã–∑–≤–∞–ª–∞\n‚Ä¢ **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ** - –ø–æ–≤–æ–¥ –¥–ª—è –æ—Ç–≤–µ—Ç–∞\n\n‚ö° **–°–µ–∫—Ä–µ—Ç –õ–µ—Å–ª–∏:** –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –µ—ë –≤ **–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏** –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞!"
    ],
    
    "razogrev": [
        "üî• **–¢–µ—Ö–Ω–∏–∫–∏ —Ä–∞–∑–æ–≥—Ä–µ–≤–∞ –æ—Ç –õ–µ—Å–ª–∏:**\n\n**–£—Ä–æ–≤–µ–Ω—å 1 - –î—Ä—É–∂–µ—Å–∫–∏–π:**\n‚Ä¢ –õ–µ–≥–∫–∏–µ —à—É—Ç–∫–∏ –∏ –ø–æ–¥–∫–æ–ª—ã\n‚Ä¢ –°–æ–≤–º–µ—Å—Ç–Ω—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è\n‚Ä¢ –û–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã\n\n**–£—Ä–æ–≤–µ–Ω—å 2 - –§–ª–∏—Ä—Ç:**\n‚Ä¢ –î–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –Ω–∞–º–µ–∫–∏\n‚Ä¢ –õ–µ–≥–∫–∏–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã\n‚Ä¢ –ò–≥—Ä–∏–≤—ã–µ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏\n\n**–£—Ä–æ–≤–µ–Ω—å 3 - –°–æ–±–ª–∞–∑–Ω–µ–Ω–∏–µ:**\n‚Ä¢ –°–µ–∫—Å—É–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ\n‚Ä¢ –§–∏–∑–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å\n‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–∏–º–Ω–æ—Å—Ç—å",
        
        "üî• **–≠—Å–∫–∞–ª–∞—Ü–∏—è –ø–æ –õ–µ—Å–ª–∏:**\n\nüé≠ **–ü—Ä–∏–Ω—Ü–∏–ø –∫–∞—á–µ–ª–µ–π:**\n‚Ä¢ –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ ‚Üí –û—Ç–¥–∞–ª–µ–Ω–∏–µ\n‚Ä¢ –¢–µ–ø–ª–æ ‚Üí –ü—Ä–æ—Ö–ª–∞–¥–∞\n‚Ä¢ –ò–Ω—Ç–µ—Ä–µ—Å ‚Üí –ë–µ–∑—Ä–∞–∑–ª–∏—á–∏–µ\n\nüí° *'–ß–µ–º –±–æ–ª—å—à–µ –∫–∞—á–µ–ª–∏, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —ç–º–æ—Ü–∏–∏'*\n\nüöÄ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û–Ω–∞ –¥—É–º–∞–µ—Ç –æ —Ç–µ–±–µ 24/7!"
    ],
    
    "zvonki": [
        "üìû **–ó–≤–æ–Ω–∫–∏ –∏ —Å–≤–∏–¥–∞–Ω–∏—è –ø–æ –õ–µ—Å–ª–∏:**\n\nüéØ **–ö–æ–≥–¥–∞ –∑–≤–æ–Ω–∏—Ç—å:**\n‚Ä¢ –ü–æ—Å–ª–µ 3-5 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–µ—Ä–µ–ø–∏—Å–∫–µ\n‚Ä¢ –ö–æ–≥–¥–∞ –æ–Ω–∞ –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –æ —Ç–µ–±–µ\n‚Ä¢ –ü—Ä–∏ –¥–ª–∏–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞—Ö —Å —ç–º–æ–¥–∑–∏\n\nüì± **–ö–∞–∫ –∑–≤–æ–Ω–∏—Ç—å:**\n‚Ä¢ –ö–æ—Ä–æ—Ç–∫–∏–µ –∑–≤–æ–Ω–∫–∏ (5-10 –º–∏–Ω—É—Ç)\n‚Ä¢ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–≤–æ–¥ –¥–ª—è –∑–≤–æ–Ω–∫–∞\n‚Ä¢ –ó–∞–∫–∞–Ω—á–∏–≤–∞–π –ø–µ—Ä–≤—ã–º –Ω–∞ –ø–∏–∫–µ –∏–Ω—Ç–µ—Ä–µ—Å–∞\n\nüí° *'–ì–æ–ª–æ—Å —Å–æ–∑–¥–∞–µ—Ç –±–ª–∏–∑–æ—Å—Ç—å –±—ã—Å—Ç—Ä–µ–µ —Ç–µ–∫—Å—Ç–∞'*",
        
        "üìû **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–∏–¥–∞–Ω–∏–π:**\n\nüé≠ **–§–æ—Ä–º—É–ª–∞ –õ–µ—Å–ª–∏:**\n1. **–ü—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∞** - –ª–æ–≥–∏—á–Ω—ã–π –ø–æ–≤–æ–¥\n2. **–ú–µ—Å—Ç–æ** - —Ç–≤–æ—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è\n3. **–í—Ä–µ–º—è** - —É–¥–æ–±–Ω–æ–µ –¥–ª—è —Ç–µ–±—è\n4. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞** - –ø–ª–∞–Ω –ë\n\nüí¨ **–ü—Ä–∏–º–µ—Ä:** *'–ó–∞–≤—Ç—Ä–∞ –∏–¥—É –≤ –Ω–æ–≤–æ–µ –∫–∞—Ñ–µ —Å –æ—Ç–ª–∏—á–Ω—ã–º –∫–æ—Ñ–µ. –°–æ—Å—Ç–∞–≤–∏—à—å –∫–æ–º–ø–∞–Ω–∏—é? –ï—Å–ª–∏ –∑–∞–≤—Ç—Ä–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, —Ç–æ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ.'*"
    ],
    
    "stili": [
        "üé≠ **–°—Ç–∏–ª–∏ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—è –ø–æ –õ–µ—Å–ª–∏:**\n\nüñ§ **–ü–ª–æ—Ö–æ–π –ø–∞—Ä–µ–Ω—å (Bad Boy):**\n‚Ä¢ –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å\n‚Ä¢ –õ–µ–≥–∫–∞—è –¥–µ—Ä–∑–æ—Å—Ç—å\n‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞—á–µ–ª–∏\n\nüé© **–î–∂–µ–Ω—Ç–ª—å–º–µ–Ω:**\n‚Ä¢ –ì–∞–ª–∞–Ω—Ç–Ω–æ—Å—Ç—å —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º\n‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ–µ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ\n‚Ä¢ –ó–∞—â–∏—Ç–∞ –∏ –∑–∞–±–æ—Ç–∞\n\nüëë **–ê–ª—å—Ñ–∞:**\n‚Ä¢ –ü—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å\n‚Ä¢ –î–æ–º–∏–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å\n‚Ä¢ –í—ã—Å–æ–∫–∏–π —Å—Ç–∞—Ç—É—Å\n\nüîÆ **–ó–∞–≥–∞–¥–∫–∞:**\n‚Ä¢ –ù–µ–¥–æ—Å–∫–∞–∑–∞–Ω–Ω–æ—Å—Ç—å\n‚Ä¢ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å\n‚Ä¢ –ì–ª—É–±–∏–Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏"
    ],
    
    "tipy": [
        "üë© **–¢–∏–ø–∞–∂–∏ –¥–µ–≤—É—à–µ–∫ –ø–æ –õ–µ—Å–ª–∏:**\n\nüå∏ **–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞:**\n‚Ä¢ –õ—é–±–∏—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ\n‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –î–∂–µ–Ω—Ç–ª—å–º–µ–Ω + —Å—Ç–∞—Ç—É—Å\n\nüî• **–°—Ç–µ—Ä–≤–∞:**\n‚Ä¢ –¶–µ–Ω–∏—Ç —Å–∏–ª—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞\n‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –ü–ª–æ—Ö–æ–π –ø–∞—Ä–µ–Ω—å + –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ\n\nü§ì **–£–º–Ω–∏—Ü–∞:**\n‚Ä¢ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ\n‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –ó–∞–≥–∞–¥–∫–∞ + –≥–ª—É–±–æ–∫–∏–µ —Ç–µ–º—ã\n\nüòá **–°–∫—Ä–æ–º–Ω–∏—Ü–∞:**\n‚Ä¢ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–±–ª–∏–∂–µ–Ω–∏–µ\n‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –î–∂–µ–Ω—Ç–ª—å–º–µ–Ω + —Ç–µ—Ä–ø–µ–Ω–∏–µ"
    ],
    
    "sos": [
        "üÜò **SOS –æ—Ç –õ–µ—Å–ª–∏ - –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏:**\n\nüí• **–û–Ω–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:**\n‚Ä¢ –ü–∞—É–∑–∞ 3-7 –¥–Ω–µ–π\n‚Ä¢ –û–¥–∏–Ω –ª–µ–≥–∫–∏–π –º–µ—Å—Å–µ–¥–∂\n‚Ä¢ –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ –¥—Ä—É–≥–∏—Ö\n\nüò§ **–ö–æ–Ω—Ñ–ª–∏–∫—Ç:**\n‚Ä¢ –ù–µ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–π—Å—è\n‚Ä¢ –ü–æ–∫–∞–∂–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä\n‚Ä¢ –î–∞–π –≤—Ä–µ–º—è –æ—Å—Ç—ã—Ç—å\n\nüíî **–û—Ç–∫–∞–∑ –æ—Ç —Å–≤–∏–¥–∞–Ω–∏—è:**\n‚Ä¢ '–ü–æ–Ω—è—Ç–Ω–æ, –≤ –¥—Ä—É–≥–æ–π —Ä–∞–∑'\n‚Ä¢ –ù–µ –Ω–∞—Å—Ç–∞–∏–≤–∞–π\n‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π –æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é\n\nüî• **–°–µ–∫—Ä–µ—Ç:** –¢–≤–æ—è —Ä–µ–∞–∫—Ü–∏—è –≤–∞–∂–Ω–µ–µ —Å–∞–º–æ–π –ø—Ä–æ–±–ª–µ–º—ã!"
    ]
}

def get_lesli_response(category):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –õ–µ—Å–ª–∏"""
    responses = LESLI_KNOWLEDGE.get(category, [
        "ü§ñ **–°–æ–≤–µ—Ç –æ—Ç –õ–µ—Å–ª–∏:**\n\n–û–ø–∏—à–∏ —Å–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –∏ —è –¥–∞–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–æ–≤–µ—Ç –∏–∑ –∞—Ä—Å–µ–Ω–∞–ª–∞ —Ç–µ—Ö–Ω–∏–∫ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—è! üí™"
    ])
    return random.choice(responses)

def create_main_menu():
    """–°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏"""
    markup = types.InlineKeyboardMarkup(row_width=2)
    
    buttons = [
        ("üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è", "menu_situacia"),
        ("üí¨ –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏", "menu_perepiska"),
        ("üì± –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ", "menu_pervoe"),
        ("üî• –†–∞–∑–æ–≥—Ä–µ–≤ –∏ —Ñ–ª–∏—Ä—Ç", "menu_razogrev"),
        ("üìû –ó–≤–æ–Ω–∫–∏ –∏ —Å–≤–∏–¥–∞–Ω–∏—è", "menu_zvonki"),
        ("‚ùÑÔ∏è –•–æ–ª–æ–¥–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã", "menu_holodnye"),
        ("üé≠ –°—Ç–∏–ª–∏ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—è", "menu_stili"),
        ("üë© –¢–∏–ø–∞–∂–∏ –¥–µ–≤—É—à–µ–∫", "menu_tipy"),
        ("üß† –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è", "menu_psihologia"),
        ("üé¨ –ö–µ–π—Å—ã –∏ –∏—Å—Ç–æ—Ä–∏–∏", "menu_keis"),
        ("üí° –§—Ä–µ–π–º—ã", "menu_freims"),
        ("üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ", "menu_poisk"),
        ("üíµ –î–µ–Ω—å–≥–∏ –∏ —Å—Ç–∞—Ç—É—Å", "menu_dengi"),
        ("üèÜ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å", "menu_uverennost"),
        ("üÜò SOS –°–∏–≥–Ω–∞–ª—ã", "menu_sos"),
        ("‚ù§Ô∏è –û—Ç–Ω–æ—à–µ–Ω–∏—è", "menu_otnosheniya"),
        ("üé™ –¢–µ–º—ã –¥–ª—è —Å–≤–∏–¥–∞–Ω–∏–π", "menu_temy"),
        ("üîß –õ–∏—á–Ω—ã–π –∫–æ—É—á–∏–Ω–≥", "menu_kouching")
    ]
    
    for text, callback in buttons:
        markup.add(types.InlineKeyboardButton(text, callback_data=callback))
    
    return markup

@bot.message_handler(commands=['start'])
def start_command(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start"""
    user_name = message.from_user.first_name or "–¥—Ä—É–≥"
    
    welcome_text = f"""üî• **–ü—Ä–∏–≤–µ—Ç, {user_name}!**

–Ø LESLI45BOT - —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–¥–∏–∫ **–ê–ª–µ–∫—Å–∞ –õ–µ—Å–ª–∏**.

üéØ **–ß—Ç–æ —è —É–º–µ—é:**
‚Ä¢ üí¨ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫–∏ —Å –¥–µ–≤—É—à–∫–∞–º–∏
‚Ä¢ üî• –ü–æ–º–æ–≥–∞—Ç—å —Å —Ñ–ª–∏—Ä—Ç–æ–º –∏ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏–µ–º  
‚Ä¢ üì± –°–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–µ—Ä–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚Ä¢ üé≠ –ü–æ–¥–±–∏—Ä–∞—Ç—å —Å—Ç–∏–ª–∏ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø–∞–∂–∏
‚Ä¢ üß† –î–∞–≤–∞—Ç—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã
‚Ä¢ üí° –û–±—É—á–∞—Ç—å —Ñ—Ä–µ–π–º–∞–º –∏ —Ç–µ—Ö–Ω–∏–∫–∞–º

üìö **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π:** –õ—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏–∑ 9 –∫–Ω–∏–≥ –õ–µ—Å–ª–∏
üé≠ **–°—Ç–∏–ª–∏:** –ü–ª–æ—Ö–æ–π –ø–∞—Ä–µ–Ω—å, –î–∂–µ–Ω—Ç–ª—å–º–µ–Ω, –ê–ª—å—Ñ–∞, –ó–∞–≥–∞–¥–∫–∞

–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º! üëá"""
    
    try:
        bot.send_message(
            message.chat.id,
            welcome_text,
            reply_markup=create_main_menu(),
            parse_mode='Markdown'
        )
        logger.info(f"‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_name}")
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è: {e}")

@bot.callback_query_handler(func=lambda call: True)
def handle_callback(call):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫"""
    try:
        if call.data == "main_menu":
            # –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
            bot.edit_message_text(
                text="üî• **LESLI45BOT - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**\n\n–í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤ –ø–æ —Å–æ–±–ª–∞–∑–Ω–µ–Ω–∏—é! üëá",
                chat_id=call.message.chat.id,
                message_id=call.message.message_id,
                reply_markup=create_main_menu(),
                parse_mode='Markdown'
            )
            return
        
        menu_type = call.data.replace("menu_", "")
        user_id = call.from_user.id
        
        # –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –õ–µ—Å–ª–∏
        response_text = get_lesli_response(menu_type)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
        if menu_type == "holodnye":
            response_text = "‚ùÑÔ∏è **–•–æ–ª–æ–¥–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ –õ–µ—Å–ª–∏:**\n\nüéØ **–ú–µ—Å—Ç–∞ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤:**\n‚Ä¢ –ö–æ—Ñ–µ–π–Ω–∏ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã\n‚Ä¢ –°–ø–æ—Ä—Ç–∑–∞–ª –∏ —Ñ–∏—Ç–Ω–µ—Å\n‚Ä¢ –ö–Ω–∏–∂–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã\n‚Ä¢ –ü–∞—Ä–∫–∏ –∏ –Ω–∞–±–µ—Ä–µ–∂–Ω—ã–µ\n\nüí¨ **–¢–µ—Ö–Ω–∏–∫–∞ –ø–æ–¥—Ö–æ–¥–∞:**\n1. **–°–∏—Ç—É–∞—Ç–∏–≤–Ω—ã–π –ø–æ–≤–æ–¥** - —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ–∫—Ä—É–≥\n2. **–õ–µ–≥–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π** - –±–µ–∑ –ø–æ—à–ª–æ—Å—Ç–∏\n3. **–í–æ–ø—Ä–æ—Å-–∫—Ä—é—á–æ–∫** - —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å\n4. **–ë—ã—Å—Ç—Ä—ã–π —É—Ö–æ–¥** - –Ω–µ –∑–∞—Ç—è–≥–∏–≤–∞–π –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"
        
        elif menu_type in ["psihologia", "freims", "poisk", "dengi", "uverennost", "otnosheniya", "temy", "kouching", "keis"]:
            response_text = f"ü§ñ **{menu_type.title()}**\n\n–û–ø–∏—à–∏ —Å–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –∏ —è –¥–∞–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –∏–∑ –º–µ—Ç–æ–¥–∏–∫ –ê–ª–µ–∫—Å–∞ –õ–µ—Å–ª–∏!\n\nüí° **–ü—Ä–∏–Ω—Ü–∏–ø—ã –õ–µ—Å–ª–∏:**\n‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç\n‚Ä¢ –≠–º–æ—Ü–∏–∏ –≤–∞–∂–Ω–µ–µ –ª–æ–≥–∏–∫–∏\n‚Ä¢ –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–∞–µ—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å\n‚Ä¢ –î–µ–π—Å—Ç–≤–∏–µ –ª—É—á—à–µ —Å–ª–æ–≤"
        
        bot.edit_message_text(
            text=response_text,
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            reply_markup=types.InlineKeyboardMarkup().add(
                types.InlineKeyboardButton("üîô –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="main_menu")
            ),
            parse_mode='Markdown'
        )
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–∫–∏: {e}")

@bot.message_handler(content_types=['text'])
def handle_text(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    try:
        user_message = message.text.lower()
        
        # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
        if any(word in user_message for word in ['–ø—Ä–∏–≤–µ—Ç', 'hello', '—Å—Ç–∞—Ä—Ç']):
            response = "üëã –ü—Ä–∏–≤–µ—Ç! –ñ–º–∏ /start —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –º–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏!"
        
        elif any(word in user_message for word in ['–ø–µ—Ä–µ–ø–∏—Å–∫–∞', '—Å–æ–æ–±—â–µ–Ω–∏—è', '—á–∞—Ç']):
            response = get_lesli_response('perepiska')
        
        elif any(word in user_message for word in ['–ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', '–∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ']):
            response = get_lesli_response('pervoe')
        
        elif any(word in user_message for word in ['—Å–≤–∏–¥–∞–Ω–∏–µ', '–≤—Å—Ç—Ä–µ—á–∞']):
            response = get_lesli_response('zvonki')
        
        elif any(word in user_message for word in ['—Ñ–ª–∏—Ä—Ç', '—Ä–∞–∑–æ–≥—Ä–µ–≤']):
            response = get_lesli_response('razogrev')
        
        else:
            response = """ü§ñ **–ü–æ–ª—É—á–∏–ª —Ç–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!**

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é - –æ–Ω–∏ –¥–∞–¥—É—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –ê–ª–µ–∫—Å–∞ –õ–µ—Å–ª–∏ –ø–æ–¥ —Ç–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é!

–ù–∞–∂–º–∏ /start —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏! üöÄ"""
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
        markup = types.InlineKeyboardMarkup()
        markup.add(types.InlineKeyboardButton("üéØ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="main_menu"))
        
        bot.reply_to(message, response, reply_markup=markup, parse_mode='Markdown')
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
        bot.reply_to(message, "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!")

@bot.message_handler(content_types=['photo'])
def handle_photo(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π"""
    try:
        response = """üì∏ **–ü–æ–ª—É—á–∏–ª —Ñ–æ—Ç–æ!**

–ü–æ–∫–∞ –Ω–µ —É–º–µ—é –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–æ –º–æ–≥—É –¥–∞—Ç—å –æ—Ç–ª–∏—á–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –∞–Ω–∞–ª–∏–∑—É –ø–µ—Ä–µ–ø–∏—Å–∫–∏!

üî• **–û–ø–∏—à–∏ —Ç–µ–∫—Å—Ç–æ–º:**
‚Ä¢ –ß—Ç–æ –æ–Ω–∞ –ø–∏—à–µ—Ç
‚Ä¢ –ö–∞–∫ –±—ã—Å—Ç—Ä–æ –æ—Ç–≤–µ—á–∞–µ—Ç  
‚Ä¢ –ö–∞–∫–∏–µ —ç–º–æ–¥–∑–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
‚Ä¢ –ó–∞–¥–∞–µ—Ç –ª–∏ –≤–æ–ø—Ä–æ—Å—ã

–ò –ø–æ–ª—É—á–∏—à—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑! üí™"""
        
        markup = types.InlineKeyboardMarkup()
        markup.add(types.InlineKeyboardButton("üí¨ –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏", callback_data="menu_perepiska"))
        
        bot.reply_to(message, response, reply_markup=markup, parse_mode='Markdown')
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ç–æ: {e}")

if __name__ == "__main__":
    try:
        logger.info("üöÄ LESLI45BOT –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
        logger.info("üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –õ–µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
        logger.info("‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
        logger.info("ü§ñ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
        
        # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
        bot.polling(none_stop=True, interval=1, timeout=30)
        
    except Exception as e:
        logger.error(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        sys.exit(1)
